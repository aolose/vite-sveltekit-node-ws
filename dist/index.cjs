"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const p=require("http"),d=require("https");let n,i,l,o;const m=e=>{const t=e.on;e.on=function(...r){r[0]==="request"?(t.call(this,"request",function(s,v){S(s.url)||r[1].call(this,s,v)}),o=()=>{e.on=t}):t.call(this,...r)}},S=e=>{if(!(!e||!l))return l(new URL(e,"http://a.a").pathname)},u=[],a=e=>{const t=e.createServer;u.push([t,e]),e.createServer=function(...r){return u.forEach(([c,s])=>{s.createServer=c}),n=t.call(this,...r),m(n),f(),n}},f=()=>{n&&i&&setTimeout(()=>{o==null||o(),i(n)})},k=()=>{n||(a(p),a(d))},h=e=>{n=e.httpServer};function w(e){return{name:"vite-sveltekit-node-ws",config(t){const r=t.server=t.server||{};(r.hmr===!0||!r.hmr)&&(r.hmr={}),r.hmr.port=e||(r.port||57777)+1},async transform(t,r){return r.endsWith("@sveltejs/kit/src/runtime/server/index.js")?{code:t.replace(/([\s\S]*import.*?from.*?(['"]).*?\2;\n)/,`$1import {handle} from 'vite-sveltekit-node-ws';
handle();`)}:null},configurePreviewServer:h,configureServer:h}}const b=(e,t)=>{l=t,i=e,f()};exports.default=w;exports.handle=k;exports.useServer=b;
