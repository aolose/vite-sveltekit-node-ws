"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const h=require("http"),p=require("https"),g=require("events");let e,n;const a=[],v=r=>{const t=r.createServer;a.push([t,r]),r.createServer=function(...s){return a.forEach(([l,o])=>{o.createServer=l}),e=t.call(this,...s),n&&n(e),e}},S=()=>{e||(v(h),v(p))},f=r=>{if(e=r.httpServer,console.log("srv",!!e),!e)return;const t=e.on,s=g.getEventListeners(e,"upgrade");e.on=function(l,o){if(l==="upgrade"){this==null||this.removeAllListeners("upgrade"),t.call(this,"upgrade",(c,i,u)=>{c.url==="/"?s.forEach(d=>d.call(this,c,i,u)):o.call(this,c,i,u)});return}t.call(this,l,o)},n&&n(e)};function m(){return{name:"svelte-kit-websocket",async transform(r,t){return t.endsWith("@sveltejs/kit/src/runtime/server/index.js")?{code:r.replace(/([\s\S]*import.*?from.*?('|").*?\2;\n)/,`$1import {handle} from 'vite-sveltekit-node-ws';
handle();`)}:null},configurePreviewServer:f,configureServer:f}}const b=r=>{e?r(e):n=r};exports.default=m;exports.handle=S;exports.server=b;
