"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const d=require("http"),p=require("https"),g=require("events");let e,n;const a=[],v=r=>{const t=r.createServer;a.push([t,r]),r.createServer=function(...s){return a.forEach(([c,l])=>{l.createServer=c}),e=t.call(this,...s),n&&n(e),e}},S=()=>{e||(v(d),v(p))},f=r=>{if(e=r.httpServer,console.log("srv",!!e),!e)return;const t=e.on,s=g.getEventListeners(e,"upgrade");e.on=function(c,l){if(c==="upgrade"){this==null||this.removeAllListeners("upgrade"),t.call(this,"upgrade",(i,o,u)=>{i.url==="/"?s.forEach(h=>h.call(this,i,o,u)):l.call(this,i,o,u)});return}t.call(this,c,l)},n&&n(e)};function m(){return{name:"svelte-kit-websocket",async transform(r,t){return t.endsWith("@sveltejs/kit/src/runtime/server/index.js")?{code:r.replace(/([\s\S]*import.*?from.*?('|").*?\2;\n)/,`$1import {handle} from 'vite-sveltekit-cf-ws';
handle();`)}:null},configurePreviewServer:f,configureServer:f}}const b=r=>{e?r(e):n=r};exports.default=m;exports.handle=S;exports.server=b;
